<!DOCTYPE html>
<html lang="ja" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <title>WebP Canvas Player</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.0.7/dist/full.css" rel="stylesheet" />
</head>
<body class="min-h-screen bg-base-200 text-base-content flex flex-col items-center p-4" ondragover="event.preventDefault()" ondrop="handleDrop(event)">

  <!-- âœ… ä¸€ç•ªä¸Šã«ã‚¿ã‚¤ãƒˆãƒ« -->
  <h1 class="text-3xl font-bold text-center mb-6">WebP Canvas Player</h1>

  <div class="w-full max-w-6xl flex flex-col gap-6">

    <!-- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ + ä¿å­˜ãƒã‚§ãƒƒã‚¯ -->
    <div class="flex flex-col md:flex-row items-center justify-center gap-4">
      <input type="file" id="fileInput" accept=".webp" class="file-input file-input-bordered w-full max-w-md" />

      <label class="label cursor-pointer gap-2">
        <span class="label-text">ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä¿å­˜ã™ã‚‹</span>
        <input type="checkbox" id="saveCheckbox" class="toggle toggle-sm" />
      </label>
    </div>

    <!-- ãƒ¡ã‚¤ãƒ³è¡¨ç¤ºï¼šcanvas + ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«æ¨ªä¸¦ã³ã‚’2åˆ†å‰² -->
    <div class="flex gap-6 justify-center w-full">
      <!-- ğŸ¥ canvasï¼šå·¦å´ 50%ã«å›ºå®š -->
      <div class="w-1/2 flex justify-end">
        <div class="border border-base-content rounded">
          <canvas id="canvas" class="rounded w-auto h-auto max-h-[80vh]" style="max-width: 100%; height: auto;"></canvas>
        </div>
      </div>

      <!-- ğŸ› ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«ï¼šå³å´ 50%ã«å›ºå®š -->
      <div class="w-1/2 flex flex-col gap-4">
        <!-- â–¶ â¸ â® â­ -->
        <div class="flex gap-2 flex-wrap">
          <button onclick="play()" class="btn btn-success btn-sm">â–¶ å†ç”Ÿ</button>
          <button onclick="pause()" class="btn btn-error btn-sm">â¸ åœæ­¢</button>
          <button onclick="prevFrame()" class="btn btn-info btn-sm">â® å‰</button>
          <button onclick="nextFrame()" class="btn btn-info btn-sm">â­ æ¬¡</button>
          <button onclick="resetFrame()" class="btn btn-warning btn-sm">ğŸ” æœ€åˆ</button>
        </div>

        <!-- å†ç”Ÿã‚¹ãƒ”ãƒ¼ãƒ‰ -->
        <div class="flex flex-col gap-1">
  <label for="speedRange" class="label-text">Speed: <span id="speedDisplay">1.00x</span></label>
  <input type="range" id="speedRange" min="0.25" max="4" step="0.01" value="1"
         class="range range-accent range-xs" />
</div>

        <!-- ã‚·ãƒ¼ã‚¯ãƒãƒ¼ -->
        <div class="flex flex-col gap-2">
          <input type="range" id="seekbar" min="0" max="0" value="0"
                 class="range range-primary h-2" />
          <div class="text-sm text-center opacity-70" id="frameInfo">Frame 0 / 0</div>
        </div>

        <!-- ã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
        <div class="flex items-center justify-between">
          <label class="label cursor-pointer gap-2">
            <span class="label-text">ãƒ«ãƒ¼ãƒ—</span>
            <input type="checkbox" id="loopToggle" class="toggle toggle-sm" />
          </label>

          <button onclick="toggleFullscreen()" class="btn btn-sm btn-outline">â›¶ ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    function handleDrop(event) {
      event.preventDefault();
      const file = event.dataTransfer.files[0];
      if (!file) return;
      document.getElementById("fileInput").files = event.dataTransfer.files;
      document.getElementById("fileInput").dispatchEvent(new Event("change"));
    }
  </script>
  <script src="/static/script.js"></script>
<script>
  document.addEventListener("keydown", (e) => {
    if (e.target.tagName === "INPUT" || e.target.tagName === "SELECT") return;

    if (e.code === "Space") {
      e.preventDefault();
      if (playing) pause();
      else play();
    } else if (e.code === "ArrowLeft") {
      prevFrame();
    } else if (e.code === "ArrowRight") {
      nextFrame();
    }
  });
</script>
</body>
</html>
